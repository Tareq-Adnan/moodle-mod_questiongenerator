define("mod_questiongenerator/quiz_handle",["exports","core/ajax","jquery"],(function(_exports,_ajax,_jquery){var obj;
/**
   * TODO describe module quiz_handle
   *
   * @module     mod_questiongenerator/quiz_handle
   * @copyright  2024 YOUR NAME <your@email.com>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.quizHandling=void 0,_jquery=(obj=_jquery)&&obj.__esModule?obj:{default:obj};_exports.quizHandling=async(cmid,quizid,marks)=>{let currentTab=0;var next=document.getElementById("nextBtn"),prev=document.getElementById("prevBtn");document.getElementById("quizForm");function showTab(n){let x=document.getElementsByClassName("step");(0,_jquery.default)("#formSpinner").hide(),x[n].style.display="block";let progress=n/(x.length-1)*100;document.querySelector(".progress-bar").style.width=progress+"%",document.querySelector(".progress-bar").setAttribute("aria-valuenow",progress),document.getElementById("prevBtn").style.display=0==n?"none":"inline",document.getElementById("nextBtn").innerHTML=n==x.length-1?"Submit":"Next"}function nextPrev(n){let x=document.getElementsByClassName("step");if(1==n&&!function(){let valid=!1,y=document.getElementsByClassName("step")[currentTab].getElementsByTagName("input");for(var i=0;i<y.length;i++)if("radio"===y[i].type&&y[i].checked){valid=!0;break}return valid}())return!1;x[currentTab].style.display="none",currentTab+=n,currentTab>=x.length?document.getElementById("nextBtn").setAttribute("type","submit"):showTab(currentTab)}showTab(currentTab),next.addEventListener("click",(function(){nextPrev(1)})),prev.addEventListener("click",(function(){nextPrev(-1)})),(0,_jquery.default)(document).on("submit","#quizForm",(event=>{event.preventDefault(),next.innerHTML='<span class="spinner-border text-light" role="status" style=\'height:1.5rem !important; width:1.5rem !important;vertical-align:middle !important\'>\n                            </span>',(0,_jquery.default)("#nextBtn").prop("disabled",!0);let formDataAssocArray=[];(0,_jquery.default)('#quizForm input[type="radio"]:checked').each((function(){const questionId=(0,_jquery.default)(this).attr("name").split("_")[1],answerIndex=(0,_jquery.default)(this).val(),refValue=(0,_jquery.default)(this).data("ref"),type=(0,_jquery.default)(this).data("type");formDataAssocArray.push({answer:answerIndex,question:questionId,ref:refValue,type:type.toLowerCase()})})),(0,_ajax.call)([{methodname:"mod_questiongenerator_attempt_quiz",args:{cmid:cmid,status:"finished"}}])[0].done((response=>{})).fail((error=>{throw new Error(error.message)})),(0,_ajax.call)([{methodname:"mod_questiongenerator_end_quiz",args:{quiz_data:formDataAssocArray,cmid:cmid,quizid:parseInt(quizid),marks:marks}}])[0].done((response=>{var correct,wrong,mark,totalmark;console.log(response),response.status?((0,_jquery.default)("#quizContainer").html((correct=response.correct_ans,wrong=response.wrong,mark=response.total,totalmark=response.rawmark,'\n        <div class="success-checkmark">\n            <div class="check-icon">\n                <span class="icon-line line-tip"></span>\n                <span class="icon-line line-long"></span>\n                <div class="icon-circle"></div>\n                <div class="icon-fix"></div>\n            </div>\n        </div>\n        <div class=\'text-center\'>\n        <h4 style="color: #008304;">Quiz Finished!</h4>\n       <div class="alert alert-secondary d-flex justify-content-between align-items-center p-3">\n    <div class=\'mx-auto\'>\n        <p class="mb-1">\n            <span class=\'text-success\'>You got <strong>'.concat(mark,"</strong> out of <strong>").concat(totalmark,"</strong> marks.</span>\n        </p>\n        <p class=\"mb-1\">\n            <span><strong class=' text-success'>Correct:</strong> ").concat(correct,", <strong class=' text-warning'>Wrong:</strong> ").concat(wrong,"</span>\n        </p>\n        <a class='text-center' style='font-weight:400' href='quizresult.php?id=").concat(cmid,"&user=0&quiz=").concat(quizid,'\'> See in Details</a>\n    </div>\n    <div>\n        <i class="bi bi-check-circle-fill text-success" style="font-size: 1.5rem;"></i>\n    </div>\n</div>\n<small id=\'redirect-text\' class="text-muted d-block text-center mt-3">Will be redirecting to course page</small>\n\n    '))),setInterval((()=>{(0,_jquery.default)("#redirect-text").append(".")}),1e3),setTimeout((function(){window.location.href=response.redirect}),5e3)):((0,_jquery.default)("#quizContainer").html("<p class=\"text-danger text-center bold\">Something went wrong! Please try again later.</p> <small id='redirect-text'></small>"),setInterval((()=>{(0,_jquery.default)("#redirect-text").append(".")}),1e3),setTimeout((function(){window.location.href=response.redirect}),5e3))})).fail((error=>{console.error("Error:",error.message)}))}))}}));

//# sourceMappingURL=quiz_handle.min.js.map